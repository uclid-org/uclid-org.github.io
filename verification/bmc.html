<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Bounded Model Checking - uclid-docs</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="Documentation for UCLID5">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="../favicon.svg">
        
        
        <link rel="shortcut icon" href="../favicon.png">
        
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        
        <link rel="stylesheet" href="../css/print.css" media="print">
        

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../introduction/prerequisites.html"><strong aria-hidden="true">1.1.</strong> Prerequisites</a></li><li class="chapter-item expanded "><a href="../introduction/installation.html"><strong aria-hidden="true">1.2.</strong> Installation Guide</a></li><li class="chapter-item expanded "><a href="../introduction/firstlook.html"><strong aria-hidden="true">1.3.</strong> A first look at UCLID5</a></li></ol></li><li class="chapter-item expanded "><a href="../language/language.html"><strong aria-hidden="true">2.</strong> Language</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/datatypes.html"><strong aria-hidden="true">2.1.</strong> Datatypes</a></li><li class="chapter-item expanded "><a href="../language/variables.html"><strong aria-hidden="true">2.2.</strong> Variables</a></li><li class="chapter-item expanded "><a href="../language/statements.html"><strong aria-hidden="true">2.3.</strong> Statements</a></li><li class="chapter-item expanded "><a href="../language/blocks.html"><strong aria-hidden="true">2.4.</strong> init, next, control</a></li><li class="chapter-item expanded "><a href="../language/procedures.html"><strong aria-hidden="true">2.5.</strong> Procedures</a></li><li class="chapter-item expanded "><a href="../language/modules.html"><strong aria-hidden="true">2.6.</strong> Modules</a></li><li class="chapter-item expanded "><a href="../language/reference.html"><strong aria-hidden="true">2.7.</strong> Language Reference</a></li></ol></li><li class="chapter-item expanded "><a href="../verification/verification.html"><strong aria-hidden="true">3.</strong> Verification</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../verification/specification.html"><strong aria-hidden="true">3.1.</strong> Specification</a></li><li class="chapter-item expanded "><a href="../verification/bmc.html" class="active"><strong aria-hidden="true">3.2.</strong> Bounded Model Checking</a></li><li class="chapter-item expanded "><a href="../verification/induction.html"><strong aria-hidden="true">3.3.</strong> Inductive Proofs</a></li><li class="chapter-item expanded "><a href="../verification/refinement.html"><strong aria-hidden="true">3.4.</strong> Verifying Refinement</a></li><li class="chapter-item expanded "><a href="../verification/hyperproperties.html"><strong aria-hidden="true">3.5.</strong> Verifying Hyperproperties</a></li><li class="chapter-item expanded "><a href="../verification/floydhoare.html"><strong aria-hidden="true">3.6.</strong> Floyd-Hoare</a></li><li class="chapter-item expanded "><a href="../verification/smto.html"><strong aria-hidden="true">3.7.</strong> SMTO</a></li></ol></li><li class="chapter-item expanded "><a href="../synthesis/synthesis.html"><strong aria-hidden="true">4.</strong> Synthesis</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../synthesis/basics.html"><strong aria-hidden="true">4.1.</strong> Synthesis Basics</a></li><li class="chapter-item expanded "><a href="../synthesis/sygus.html"><strong aria-hidden="true">4.2.</strong> Syntax Guided Synthesis</a></li><li class="chapter-item expanded "><a href="../synthesis/smo.html"><strong aria-hidden="true">4.3.</strong> SyMO</a></li></ol></li><li class="chapter-item expanded "><a href="../advanced/advanced.html"><strong aria-hidden="true">5.</strong> Advanced Features</a></li><li class="chapter-item expanded affix "><li class="part-title">Appendix</li><li class="chapter-item expanded "><a href="../idiomatic.html"><strong aria-hidden="true">6.</strong> Idiomatic UCLID5</a></li><li class="chapter-item expanded "><a href="../tooling.html"><strong aria-hidden="true">7.</strong> Tooling</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">uclid-docs</h1>

                    <div class="right-buttons">
                        
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bounded-model-checking-bmc"><a class="header" href="#bounded-model-checking-bmc">Bounded Model Checking (BMC)</a></h1>
<p>Bounded Model Checking (BMC) is a useful technique for bounded verification and bug finding.</p>
<p>(Note: the <code>unroll</code> command is a now deprecated command which performs bounded model checking for non-LTL properties only. <code>bmc</code> performs bounded model checking for both LTL and non-LTL properties)</p>
<p>The Fibonacci example (introduced in <a href="/introduction/firstlook.html">A first look at UCLID5</a>) is reproduced below but now with the <code>bmc</code> command, which has the same semantics as the <code>unroll</code> command.</p>
<pre><code class="language-uclid">module main {
    var a, b : integer;
    
    init {
        a = 0; b = 1;
    }

    next {
        a’, b’ = b, a + b;
    }

    // This time the invariant will be checked by BMC 
    // 	instead of an inductiveness check.
    invariant a_le_b: a &lt;= b;

    control {
    	// The bmc command
        bmc (3);
        check;
        print_results;
    }
}
</code></pre>
<p>The <code>bmc</code> command unrolls the <code>next</code> block for 3 steps, and generates an SMT query for each step which checks whether the system can violate the property at that step.</p>
<h2 id="checking-embedded-specifications"><a class="header" href="#checking-embedded-specifications">Checking Embedded Specifications</a></h2>
<p>To demonstrate checking embedded specifications,
we now present a variant of the above Fibonacci example.</p>
<pre><code class="language-uclid">module main {
    // System description.
    var a, b : integer;
    const flag : boolean;

    procedure set_init()
        modifies a, b;
    {
        havoc a;
        havoc b;
        // embedded assumptions.
        assume (a &lt;= b);
        assume (a &gt;= 0 &amp;&amp; b &gt;= 0);
        assume (flag);
    }

    init {
        call set_init();
    }
    next {
        a', b' = b, a + b;
        if (flag) {
            assert (a' &lt;= b');
        } else {
            assert (false);
        }
    }

    // Proof script.
    control {
        unroll (3);
        check;
        print_results;
    }
}   
</code></pre>
<p>We have introduced the constant <code>flag</code> on line 4. </p>
<pre><code class="language-uclid">    const flag : boolean;
</code></pre>
<p>A constant holds a symbolic value that does not change during computation.
The initial value of the constant is assigned non-deterministically and
can be controlled using assumptions.
A second difference with between this and the first example is on lines 12–14, 23 and 25.</p>
<p>Line 12-14:</p>
<pre><code class="language-uclid">        assume (a &lt;= b);
        assume (a &gt;= 0 &amp;&amp; b &gt;= 0);
        assume (flag);
</code></pre>
<p>Line 23:</p>
<pre><code class="language-uclid">            assert (a' &lt;= b');
</code></pre>
<p>Line 25:</p>
<pre><code class="language-uclid">            assert (false);
</code></pre>
<p>Instead of using a module-level assumption declarations as in the first example,
we have three embedded assumptions in the set init procedure on lines 12–14,
and two embedded assertions in the next block on lines 23 and 25.</p>
<p>A module-level assumption is assumed to hold for the solver at every step of execution,
while an embedded assumption is assumed “instantaneously” at the location of the statement.
In particular, the assumptions on lines 12–14 tells the solver
to assume that <code>\\( a \leq b \\)</code>, <code>\\( a \geq 0 \\)</code> and <code>\\( b \leq 0 \\)</code> at the end of the <code>set_init</code> procedure.
Notice that we are not assigning specific values to a and b, instead we are asking Uclid5 to consider potential values of <code>a</code> and <code>b</code> such that <code>a ≤ b</code>, <code>a ≥ 0</code> and <code>b ≥ 0</code>.
Similarly the assertions on lines 23 and 25 are evaluated at that specific location in the
code. In particular the assertion on line 23 is only checked when <code>flag</code> is <code>true</code>,
while the assertion one line 25 is checked when <code>flag</code> is <code>false</code>.
Since <code>flag</code> is always <code>true</code> in our model, the assertion on line 25 will never fire.
In contrast, note that a module-level assertion would be evaluated after the init block
and after each execution of the next block.</p>
<p>Note that we use <code>unroll</code> here again because <code>bmc</code> currently ignores embedded specifications.
<a href="https://github.com/uclid-org/uclid/issues/181">This will be fixed</a> in a future release.</p>
<h2 id="checking-ltl-specifications"><a class="header" href="#checking-ltl-specifications">Checking LTL Specifications</a></h2>
<p>We demonstrate checking LTL Specifications using BMC
with a UCLID5 model of an intersection with two traffic lights.</p>
<p>The full UCLID5 model:</p>
<pre><code class="language-uclid">module main
{
    type light_t = enum { red, yellow, green };
    var step1, step2 : integer;
    var light1, light2 : light_t;

    init {
        light1, step1 = red,   2;
        light2, step2 = green, 1;
    }

    next {
        call (light1', step1') = next_light(light1, step1);
        call (light2', step2') = next_light(light2, step2);
    }

    procedure next_light(light : light_t, step : integer)
        returns (lightP : light_t, stepP: integer)
    {
        if (step == 0) {
            case
            (light == green) : {
                lightP = yellow;
                stepP = step;
            }
            (light == yellow) : {
                lightP = red;
                stepP = 2;
            }
            (light == red) : {
                lightP = green;
                stepP = 1;
            }
            esac
        } else {
            lightP = light;
            stepP = step - 1;
        }
    }

    property[LTL] always_one_red: G(light1 == red || light2 == red);
    // property[LTL] eventually_green:
    //     G(F(light1 == green)) &amp;&amp; G(F(light2 == green));

    control {
        v = bmc(10);
        check;
        print_results;
        v.print_cex(light1, step1, light2, step2);
    }
}

</code></pre>
<p>Lines 3–39 define the functionality of the traffic light;
this part of the model should be familiar.</p>
<pre><code class="language-uclid">    type light_t = enum { red, yellow, green };
    var step1, step2 : integer;
    var light1, light2 : light_t;

    init {
        light1, step1 = red,   2;
        light2, step2 = green, 1;
    }

    next {
        call (light1', step1') = next_light(light1, step1);
        call (light2', step2') = next_light(light2, step2);
    }

    procedure next_light(light : light_t, step : integer)
        returns (lightP : light_t, stepP: integer)
    {
        if (step == 0) {
            case
            (light == green) : {
                lightP = yellow;
                stepP = step;
            }
            (light == yellow) : {
                lightP = red;
                stepP = 2;
            }
            (light == red) : {
                lightP = green;
                stepP = 1;
            }
            esac
        } else {
            lightP = light;
            stepP = step - 1;
        }
    }
</code></pre>
<p>The current state of the lights are stored in the variables <code>light1</code> and <code>light2</code>,
and these switch from <code>red</code> to <code>green</code> to <code>yellow</code> and back to <code>red</code>.
The variables <code>step1</code> and <code>step2</code> can be thought of timers,
and ensure that each light stays red for three transitions,
green for two transitions and stays yellow for a single transition.</p>
<p>The LTL properties are on lines 41-43.</p>
<pre><code class="language-uclid">    property[LTL] always_one_red: G(light1 == red || light2 == red);
    // property[LTL] eventually_green:
    //     G(F(light1 == green)) &amp;&amp; G(F(light2 == green));
</code></pre>
<p>The property <code>always_one_red</code> specifies a safety property which states
that at least one of the two lights must be <code>red</code> in every particular cycle.
The notation <code>G(φ)</code> refers to the LTL globally operator,
while the notation <code>F(φ)</code> refers to the LTL eventually (future) operator.
Other supported operators include next-time: <code>X(φ)</code>, (strong-)until: <code>U(φ1, φ2)</code>
and weak-until: <code>W(φ1, φ2)</code>.
<code>always_one_red</code> is a safety property.
The property <code>eventually_green</code> is an example of liveness property,
and specifies that both lights become <code>green</code> infinitely often.
The command for bounded verification of LTL properties is the <code>bmc</code> command.
This is invoked on line 46.</p>
<pre><code class="language-uclid">        v = bmc(10);
</code></pre>
<p>Note that, currently, a UCLID5 model can only have one LTL property at a time.
<a href="https://github.com/uclid-org/uclid/issues/128">This will be fixed</a> in a future release.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../verification/specification.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../verification/induction.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../verification/specification.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../verification/induction.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3000/__livereload");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
